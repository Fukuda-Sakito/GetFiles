INFOSS と誓約書の合格者反映作業を機械的に実行できるようにしたいです．  

infoss.sh を実行すると作業を行ってくれるような設計です．  
エラーコードを認識すると，axioleに設定の変更を送信する前で止まるようになっています．  
このタイミングで止めるのは，エラーメッセージをすべて表示し，原因を確認しやすくするためです．  

また，ログイン時に必要な情報を分けるため，リポジトリにはないが，~/mypasswd.txt が必要です．  
このページの最下部で説明しています．  


以下，各ファイルの説明です．  

checktxt.py  
> get_files.py にて取得してきた成績一覧が反映作業に用いて良いものかを判定しています．  
  例) result-utf8-english.txt では下記点を確認しています．  
  > > * 内に"英語版"の文字列が含まれているかどうか  
  > > * 管理者を含んでいるか，すなわち，反映作業を行っている人のUECアカウントを含んでいるかどうか  

checkxlsx.py  
> writexlsx.py にて INFOSS統計.xlsx 値を正しく書き込んだかを確認しています．  
  書き込むべき４つの値はわかっているのでそれが最新行に書き込まれているのかを見ています．  

copy.pl  
> SGの makepager-axiole.pl をコピーし，一部編集したファイルです．  
  makepager-axiole.pl を壊さないように writexlsx.py にて用いる４つの値を引き渡すことが目的です．  

get_files.py  
> WebClass から反映作業に用いる .txt を取得するためのファイルです．  
  /usr/bin/google-chrome を selenium でスクレイピングします．  
  反映作業に移る前に必ず checktxt.py にて確認させてください．  

infoss.sh  
> このファイルにて繁栄作業を順次実行していきます．  
  主な内容は SG にて指示されているコマンドを順に実行していきます．  
  その前後にて必要な情報を取得して来たり，それを確認したり，Slackにて報告したりしています．  

post_slack.sh  
> 反映作業が完了した段階で土屋先生に反映作業が終わった旨を Slackにてメンションします．  
  事前に https://api.slack.com/apps/A0264PMK1LZ にて，下記を登録する必要があります．  
> > * 自分のユーザートークン

rename.sh  
> 取得してきた result-utf8.txt の無印から(4)までをそれぞれファイル名を "result-utf8-english.txt" などに書き換えます．  
  目的はコピペミスなどのヒューマンエラー防止です．  
  ファイルを取得してきた順番がおかしかったり，必要なファイルが欠けているとエラーとして終了する．  

writexlsx.py  
> copy.pl から流れてきた，書き込むべき4つの値を INFOSS統計.xlsx へ書き込みます．  
  このファイル実行時に，バックアップを取得します．  
  エクセルファイルを編集する前に /home/cc/docs/INFOSS/backup_xlsx/ へコピーしてバックアップを残します．  
  7月12日現在は作業から5回前までをバックアップとして取得しています．  
  
また，リポジトリ上では管理していませんが，別途 ~/mypasswd.txt が必要となります．  
このファイルは下記のような4行の情報を記録しており，プログラム上で利用する各個人の情報を参照できるようにしてあります．  
> * UECアカウント
  * UECアカウントのパスワード
  * 使用するクロームドライバーのパス
  * Slackのユーザートークン# GetFiles
# GetFiles
